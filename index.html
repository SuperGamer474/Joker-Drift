<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joker Drift Card Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a5f23, #0d3d1a);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            max-width: 900px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            font-size: 2.8rem;
            margin-bottom: 5px;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #aaffaa;
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 900px;
            gap: 20px;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-between;
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .stat-box {
            text-align: center;
            flex: 1;
            padding: 10px;
            background: rgba(0, 40, 0, 0.6);
            border-radius: 10px;
            margin: 0 5px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ffd700;
        }
        
        .game-board {
            position: relative;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            min-height: 400px;
        }
        
        .card-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
            min-height: 180px;
        }
        
        .card-slot {
            width: 120px;
            height: 180px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .black-card {
            background: rgba(30, 30, 50, 0.7);
            border: 2px dashed #666;
        }
        
        .joker-slot {
            background: rgba(180, 0, 0, 0.3);
            border: 2px solid #ff5555;
        }
        
        .card {
            width: 120px;
            height: 180px;
            border-radius: 10px;
            background: #fff;
            position: absolute;
            cursor: pointer;
            transition: all 0.5s ease;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }
        
        .card.red {
            border: 2px solid #e74c3c;
        }
        
        .card.black {
            border: 2px solid #2c3e50;
        }
        
        .deck-container {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }
        
        .deck {
            width: 120px;
            height: 180px;
            border-radius: 10px;
            background: linear-gradient(45deg, #8b4513, #5d2906);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
            position: relative;
            border: 2px solid #5d2906;
            transition: transform 0.2s;
        }
        
        .deck:active {
            transform: scale(0.98);
        }
        
        .deck-count {
            position: absolute;
            bottom: -25px;
            font-size: 1.2rem;
            color: #ffd700;
            background: rgba(0, 0, 0, 0.6);
            padding: 3px 10px;
            border-radius: 15px;
        }
        
        .deck i {
            font-size: 2.5rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .discard-pile {
            width: 120px;
            height: 180px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            border: 2px dashed #666;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1.1rem;
            background: linear-gradient(to bottom, #ffd700, #ff9800);
            border: none;
            border-radius: 50px;
            color: #2c3e50;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
            background: linear-gradient(to bottom, #ffdf33, #ffa726);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            max-width: 900px;
        }
        
        .instructions h2 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .instructions ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 30px 50px;
            border-radius: 15px;
            text-align: center;
            z-index: 100;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.7);
            border: 2px solid #ffd700;
            display: none;
        }
        
        .message h2 {
            color: #ffd700;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }
        
        .message p {
            font-size: 1.3rem;
            margin-bottom: 25px;
        }
        
        .highscore {
            color: #ffd700;
            font-size: 1.8rem;
            margin-top: 10px;
        }
        
        .joker-card {
            background: linear-gradient(135deg, #2c3e50, #1a1a2e);
            color: #fff;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px solid #ff5555;
            width: 120px;
            height: 180px;
            border-radius: 10px;
        }
        
        .joker-text {
            font-size: 1.2rem;
            font-weight: bold;
            color: #ff5555;
            text-align: center;
            margin-top: 10px;
        }
        
        @keyframes dealCard {
            0% { transform: translateY(-20px) rotate(-5deg); opacity: 0; }
            100% { transform: translateY(0) rotate(0); opacity: 1; }
        }
        
        @keyframes slideRight {
            0% { transform: translateX(0); }
            100% { transform: translateX(135px); }
        }
        
        @keyframes float {
            0% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0); }
        }
        
        .float {
            animation: float 3s ease-in-out infinite;
        }
        
        .score-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 900px;
            margin-top: 20px;
        }
        
        .score-box {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            flex: 1;
            margin: 0 10px;
        }
        
        .score-box h3 {
            color: #ffd700;
            margin-bottom: 10px;
        }
        
        .score-value {
            font-size: 2rem;
            color: #4caf50;
        }
        
        .discard-pair {
            position: relative;
            width: 120px;
            height: 180px;
            margin: 5px;
        }
        
        .discard-pair .card {
            position: absolute;
        }
        
        .discard-pair .card:first-child {
            transform: rotate(-10deg);
            z-index: 1;
        }
        
        .discard-pair .card:last-child {
            transform: rotate(10deg);
            left: 30px;
        }
        
        @media (max-width: 768px) {
            .card-row {
                flex-wrap: wrap;
            }
            
            .card-slot, .card, .deck, .discard-pile {
                width: 90px;
                height: 135px;
            }
            
            .joker-card {
                width: 90px;
                height: 135px;
            }
            
            .discard-pair .card:last-child {
                left: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>JOKER DRIFT</h1>
        <div class="subtitle">A Card Game of Luck, Pairing, and Drifting Jokers</div>
        <div>Single Player Mode - Beat Your High Score!</div>
    </header>
    
    <div class="game-container">
        <div class="stats-container">
            <div class="stat-box">
                <div>DRIFT COUNT</div>
                <div class="stat-value" id="drift-count">0</div>
            </div>
            <div class="stat-box">
                <div>CARDS LEFT</div>
                <div class="stat-value" id="cards-left">34</div>
            </div>
            <div class="stat-box">
                <div>PAIRS MADE</div>
                <div class="stat-value" id="pairs-made">0</div>
            </div>
        </div>
        
        <div class="game-board">
            <div class="card-row" id="black-row">
                <!-- Black cards will be placed here dynamically -->
            </div>
            
            <div class="deck-container">
                <div class="deck" id="draw-deck">
                    <i class="fas fa-cards"></i>
                    <div class="deck-count">34</div>
                </div>
                <div class="discard-pile" id="discard-pile">
                    <!-- Discarded pairs will appear here -->
                </div>
            </div>
        </div>
        
        <div class="controls">
            <button id="deal-btn">DEAL CARD</button>
            <button id="new-game-btn">NEW GAME</button>
            <button id="hint-btn">HINT</button>
        </div>
    </div>
    
    <div class="score-container">
        <div class="score-box">
            <h3>CURRENT SCORE</h3>
            <div class="score-value" id="current-score">0</div>
        </div>
        <div class="score-box">
            <h3>BEST SCORE</h3>
            <div class="score-value" id="best-score">0</div>
        </div>
    </div>
    
    <div class="instructions">
        <h2>How to Play</h2>
        <ul>
            <li>Click <strong>DEAL CARD</strong> to draw a card from your deck</li>
            <li>If you draw a <strong style="color:#e74c3c">RED CARD</strong>, it will remove your rightmost black card and create a pair</li>
            <li>If you draw a <strong style="color:#2c3e50">BLACK CARD</strong>, your Joker will drift right and the card will be added to your row</li>
            <li><strong>WIN</strong> by clearing all black cards before your deck runs out</li>
            <li><strong>LOSE</strong> if your deck runs out before clearing all black cards</li>
            <li>Your score is calculated by how little your Joker drifted and how many cards you have left</li>
        </ul>
        <p>Pro Tip: <em>Hope for reds but plan for blacks!</em></p>
    </div>
    
    <div class="message" id="message">
        <h2 id="message-title">Game Over</h2>
        <p id="message-content"></p>
        <div class="highscore" id="highscore-display"></div>
        <button id="close-message">CONTINUE</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Card image base path (adjust this to match your actual path)
            const CARD_BASE_PATH = 'cards/';
            
            // Game state
            const gameState = {
                deck: [],
                row: [],
                discardPairs: [],
                driftCount: 0,
                cardsLeft: 34,
                pairsMade: 0,
                gameOver: false,
                jokerPosition: 6,
                bestScore: localStorage.getItem('jokerDriftBestScore') || 0
            };
            
            // DOM elements
            const elements = {
                blackRow: document.getElementById('black-row'),
                drawDeck: document.getElementById('draw-deck'),
                discardPile: document.getElementById('discard-pile'),
                dealBtn: document.getElementById('deal-btn'),
                newGameBtn: document.getElementById('new-game-btn'),
                hintBtn: document.getElementById('hint-btn'),
                driftCount: document.getElementById('drift-count'),
                cardsLeft: document.getElementById('cards-left'),
                pairsMade: document.getElementById('pairs-made'),
                currentScore: document.getElementById('current-score'),
                bestScore: document.getElementById('best-score'),
                message: document.getElementById('message'),
                messageTitle: document.getElementById('message-title'),
                messageContent: document.getElementById('message-content'),
                highscoreDisplay: document.getElementById('highscore-display'),
                closeMessage: document.getElementById('close-message')
            };
            
            // Initialize game
            initGame();
            
            // Event listeners
            elements.dealBtn.addEventListener('click', dealCard);
            elements.newGameBtn.addEventListener('click', initGame);
            elements.hintBtn.addEventListener('click', showHint);
            elements.closeMessage.addEventListener('click', () => {
                elements.message.style.display = 'none';
            });
            elements.drawDeck.addEventListener('click', dealCard);
            
            // Initialize a new game
            function initGame() {
                // Reset game state
                gameState.deck = createDeck();
                gameState.row = createInitialRow();
                gameState.discardPairs = [];
                gameState.driftCount = 0;
                gameState.cardsLeft = 34;
                gameState.pairsMade = 0;
                gameState.gameOver = false;
                gameState.jokerPosition = 6;
                
                // Update UI
                updateUI();
                renderBlackRow();
                elements.discardPile.innerHTML = '';
                elements.message.style.display = 'none';
                
                // Load best score
                gameState.bestScore = localStorage.getItem('jokerDriftBestScore') || 0;
                elements.bestScore.textContent = gameState.bestScore;
            }
            
            // Create shuffled deck
            function createDeck() {
                const suits = ['hearts', 'diamonds', 'clubs', 'spades'];
                const ranks = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'jack', 'queen', 'king', 'ace'];
                
                // Create deck with actual card images
                const deck = [];
                
                // Add red cards (hearts and diamonds)
                for (let i = 0; i < 20; i++) {
                    const suit = Math.random() > 0.5 ? 'hearts' : 'diamonds';
                    const rank = ranks[Math.floor(Math.random() * ranks.length)];
                    const color = 'red';
                    const image = `${rank}_of_${suit}.svg`;
                    deck.push({ suit, rank, color, image });
                }
                
                // Add black cards (clubs and spades)
                for (let i = 0; i < 14; i++) {
                    const suit = Math.random() > 0.5 ? 'clubs' : 'spades';
                    const rank = ranks[Math.floor(Math.random() * ranks.length)];
                    const color = 'black';
                    const image = `${rank}_of_${suit}.svg`;
                    deck.push({ suit, rank, color, image });
                }
                
                // Shuffle deck
                return shuffleDeck(deck);
            }
            
            // Shuffle deck using Fisher-Yates algorithm
            function shuffleDeck(deck) {
                for (let i = deck.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [deck[i], deck[j]] = [deck[j], deck[i]];
                }
                return deck;
            }
            
            // Create initial row of black cards
            function createInitialRow() {
                const row = [];
                const suits = ['clubs', 'spades'];
                const ranks = ['8', '9', '10', 'jack', 'queen', 'king'];
                
                for (let i = 0; i < 6; i++) {
                    const suit = suits[Math.floor(Math.random() * suits.length)];
                    const rank = ranks[Math.floor(Math.random() * ranks.length)];
                    const color = 'black';
                    const image = `${rank}_of_${suit}.svg`;
                    row.push({ suit, rank, color, image });
                }
                
                return row;
            }
            
            // Deal a card from the deck
            function dealCard() {
                if (gameState.gameOver) return;
                if (gameState.deck.length === 0) {
                    endGame(false);
                    return;
                }
                
                const card = gameState.deck.pop();
                gameState.cardsLeft--;
                
                if (card.color === 'red') {
                    handleRedCard(card);
                } else {
                    handleBlackCard(card);
                }
                
                updateUI();
                renderBlackRow();
                
                // Check win condition
                if (gameState.row.length === 0) {
                    endGame(true);
                }
            }
            
            // Handle drawing a red card
            function handleRedCard(card) {
                if (gameState.row.length > 0) {
                    // Remove the rightmost black card
                    const removedCard = gameState.row.pop();
                    gameState.discardPairs.push({ black: removedCard, red: card });
                    gameState.pairsMade++;
                    
                    // Create and display the pair in discard pile
                    displayDiscardPair(removedCard, card);
                }
            }
            
            // Handle drawing a black card
            function handleBlackCard(card) {
                // Add to row and increase drift
                gameState.row.unshift(card);
                gameState.driftCount++;
                gameState.jokerPosition++;
            }
            
            // Display a discard pair
            function displayDiscardPair(blackCard, redCard) {
                const pairContainer = document.createElement('div');
                pairContainer.className = 'discard-pair';
                
                const blackCardEl = createCardElement(blackCard);
                const redCardEl = createCardElement(redCard);
                
                blackCardEl.style.transform = 'rotate(-10deg)';
                redCardEl.style.transform = 'rotate(10deg)';
                redCardEl.style.left = '30px';
                
                pairContainer.appendChild(blackCardEl);
                pairContainer.appendChild(redCardEl);
                
                // Animate appearance
                pairContainer.style.opacity = '0';
                pairContainer.style.transform = 'translateY(20px)';
                elements.discardPile.appendChild(pairContainer);
                
                // Animate in
                setTimeout(() => {
                    pairContainer.style.transition = 'all 0.5s ease';
                    pairContainer.style.opacity = '1';
                    pairContainer.style.transform = 'translateY(0)';
                }, 10);
            }
            
            // Render the black card row
            function renderBlackRow() {
                elements.blackRow.innerHTML = '';
                
                // Create black cards
                gameState.row.forEach(card => {
                    const cardSlot = document.createElement('div');
                    cardSlot.className = 'card-slot black-card';
                    
                    const cardEl = createCardElement(card);
                    cardEl.style.animation = 'dealCard 0.5s ease-out';
                    
                    cardSlot.appendChild(cardEl);
                    elements.blackRow.appendChild(cardSlot);
                });
                
                // Create joker slot
                const jokerSlot = document.createElement('div');
                jokerSlot.className = 'card-slot joker-slot float';
                
                const jokerCard = document.createElement('div');
                jokerCard.className = 'joker-card';
                jokerCard.innerHTML = `
                    <img src="${CARD_BASE_PATH}black_joker.svg" style="width: 80px; height: 80px; margin-top: 20px;">
                    <div class="joker-text">DRIFT: ${gameState.driftCount}</div>
                `;
                
                jokerSlot.appendChild(jokerCard);
                elements.blackRow.appendChild(jokerSlot);
            }
            
            // Create a card element using SVG images
            function createCardElement(card) {
                const cardEl = document.createElement('div');
                cardEl.className = `card ${card.color}`;
                
                // Set the card image
                cardEl.style.backgroundImage = `url('${CARD_BASE_PATH}${card.image}')`;
                cardEl.style.backgroundSize = 'cover';
                
                return cardEl;
            }
            
            // Update UI elements
            function updateUI() {
                elements.driftCount.textContent = gameState.driftCount;
                elements.cardsLeft.textContent = gameState.cardsLeft;
                elements.pairsMade.textContent = gameState.pairsMade;
                
                // Update deck count
                elements.drawDeck.querySelector('.deck-count').textContent = gameState.cardsLeft;
                
                // Calculate current score
                const score = Math.max(0, 100 - (gameState.driftCount * 5) + (gameState.pairsMade * 3));
                elements.currentScore.textContent = score;
            }
            
            // End the game
            function endGame(isWin) {
                gameState.gameOver = true;
                
                // Calculate final score
                const score = Math.max(0, 100 - (gameState.driftCount * 5) + (gameState.pairsMade * 3));
                
                // Update best score if needed
                if (score > gameState.bestScore) {
                    gameState.bestScore = score;
                    localStorage.setItem('jokerDriftBestScore', score);
                    elements.bestScore.textContent = score;
                }
                
                // Show message
                elements.messageTitle.textContent = isWin ? 'You Win!' : 'Game Over!';
                elements.messageContent.innerHTML = isWin 
                    ? `Congratulations! You cleared all black cards!<br>Final Drift: ${gameState.driftCount}`
                    : 'Your deck ran out before clearing all black cards. Try again!';
                
                elements.highscoreDisplay.textContent = score > gameState.bestScore 
                    ? `ðŸŽ‰ New High Score: ${score} ðŸŽ‰` 
                    : `Best Score: ${gameState.bestScore}`;
                
                elements.message.style.display = 'block';
            }
            
            // Show game hint
            function showHint() {
                const hintMessages = [
                    "Draw red cards to remove black cards from your row!",
                    "Black cards make your Joker drift right - avoid them!",
                    "Try to clear the row before your deck runs out!",
                    "Your score is higher when your Joker drifts less!",
                    "Pair red cards with black cards to clear your row!"
                ];
                
                const randomHint = hintMessages[Math.floor(Math.random() * hintMessages.length)];
                
                // Create and show hint
                const hintElement = document.createElement('div');
                hintElement.className = 'message';
                hintElement.style.position = 'fixed';
                hintElement.style.top = '20px';
                hintElement.style.left = '50%';
                hintElement.style.transform = 'translateX(-50%)';
                hintElement.style.padding = '15px';
                hintElement.style.background = 'rgba(255, 215, 0, 0.9)';
                hintElement.style.color = '#2c3e50';
                hintElement.style.borderRadius = '10px';
                hintElement.style.fontWeight = 'bold';
                hintElement.style.zIndex = '100';
                hintElement.textContent = randomHint;
                
                document.body.appendChild(hintElement);
                
                // Remove hint after delay
                setTimeout(() => {
                    document.body.removeChild(hintElement);
                }, 3000);
            }
            
            // Initialize best score display
            elements.bestScore.textContent = gameState.bestScore;
        });
    </script>
</body>
</html>
